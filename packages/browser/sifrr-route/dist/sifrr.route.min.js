/*! Sifrr.Route v0.0.1-alpha2 - sifrr project */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@sifrr/dom")):"function"==typeof define&&define.amd?define(["@sifrr/dom"],e):(t.Sifrr=t.Sifrr||{},t.Sifrr.Route=e(t.Sifrr.Dom))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;const e=e||{};e.Dom=t;const a=e.Dom.html`<style>
  :host {
    display: none;
  }
  :host(.active) {
    display: block;
    opacity: 0;
    animation: slide 0.3s ease forwards;
  }
  @keyframes slide {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
</style>
<slot></slot>`;class s{static get template(){return a}constructor(t,e={}){this.options=Object.assign({delimiter:"/"},e),this.path=t}get regex(){return this._regex=this._regex||new RegExp("^"+this.path.replace(/:[A-Za-z0-9_]{0,}\?$/g,"([^/]{0,})?").replace(/:[A-Za-z0-9_]{0,}\?/g,"([^/]{0,})").replace(/\*\*/g,"(.{0,})").replace(/\*/g,"([^/]{0,})").replace(/:[A-Za-z0-9_]{0,}/g,"([^/]{0,})")+"$"),this._regex}get dataMap(){return this._dataMap?this._dataMap:(this._dataMap=[],this.path.split("/").forEach(t=>{":"!==t[0]&&"*"!==t&&"**"!==t||this._dataMap.push(t)}),this._dataMap)}test(t){const e={star:[],doubleStar:[]},a=this.regex.exec(t);return a&&this.dataMap.forEach((t,s)=>{"*"===t?e.star.push(a[s+1]):"**"===t?e.doubleStar.push(a[s+1]):e[t.substr(1)]=a[s+1]}),{match:!!a,data:e}}}e.Dom.Event.add("click");const i=[];class r extends e.Dom.Element{static observedAttrs(){return["data-sifrr-path"]}onConnect(){this.loaded=!1,i.push(this)}onDisconnect(){i.splice(i.indexOf(this),1)}onAttributeChange(t){"data-sifrr-path"==t&&this.refresh()}get routeRegex(){return this._routeRegex=this._routeRegex||new s(this.dataset.sifrrPath),this._routeRegex}refresh(){const t=window.location.pathname,e=this.routeRegex.test(t);e.match?(this.activate(),this.state=e.data,this.$$("[data-sifrr-route-state=true]",!1).forEach(t=>{t.dataset.sifrrState=JSON.stringify({route:e.data})})):this.deactivate()}activate(){if(!this.loaded&&(this.loaded=!0,this.dataset.sifrrElements&&this.dataset.sifrrElements.indexOf("-")>0)){this.dataset.sifrrElements.split(",").filter((t,e,a)=>a.indexOf(t)===e).forEach(t=>{e.Dom.load(t)})}this.classList.add("active")}deactivate(){this.classList.remove("active")}static refreshAll(){i.forEach(t=>{t.refresh()}),this.onRouteChange()}static onRouteChange(){}}e.Dom.register(r),document.addEventListener("click",t=>{const e=t.path?t.path[0]:t.target;if(!e.matches("a")||e.host!==window.location.host||e.target&&"_self"!==e.target)return;t.preventDefault();const a=e.getAttribute("title")||"Title",s={location:e.pathname,title:a};document.title=a,history.pushState(s,a,e.pathname),r.refreshAll()}),window.addEventListener("popstate",t=>{t.state&&t.state.title&&(document.title=t.state.title),r.refreshAll()});return{}});
/*! (c) @aadityataparia */
//# sourceMappingURL=sifrr.route.min.js.map
