/*! Sifrr.Route v0.0.2-alpha - sifrr project */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@sifrr/dom")):"function"==typeof define&&define.amd?define(["@sifrr/dom"],e):((t=t||self).Sifrr=t.Sifrr||{},t.Sifrr.Route=e(t.Sifrr.Dom))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e=class{constructor(t,e={}){this.options=Object.assign({delimiter:"/"},e),this.path=t}get regex(){return this._regex=this._regex||new RegExp("^"+this.path.replace(/\/:[A-Za-z0-9_]{0,}\?/g,"(/[^/]{0,})?").replace(/\*\*/g,"(.{0,})").replace(/\*/g,"([^/]{0,})").replace(/:[A-Za-z0-9_]{0,}/g,"([^/]{0,})")+"$"),this._regex}get dataMap(){return this._dataMap?this._dataMap:(this._dataMap=[],this.path.split("/").forEach(t=>{":"!==t[0]&&"*"!==t&&"**"!==t||this._dataMap.push(t)}),this._dataMap)}test(t){const e={"*":[],"**":[]},s=this.regex.exec(t);return s&&this.dataMap.forEach((t,r)=>{"*"===t?e["*"].push(s[r+1]):"**"===t?e["**"].push(s[r+1]):e[t.substr(1)]=s[r+1]}),e.star=e["*"],e.doubleStar=e["**"],{match:!!s,data:e}}};const s=window.Sifrr||{Dom:t},r=s.Dom.html("<style>:host{display: none;}:host(.active){display: block;}</style><slot></slot>");s.Dom.Route={RegexPath:e};const i=document.title;class a extends s.Dom.Element{static get template(){return r}static observedAttrs(){return["path"]}onConnect(){this.loaded=!1,this.constructor.all.push(this)}onDisconnect(){this.constructor.all.splice(this.constructor.all.indexOf(this),1)}onAttributeChange(t){"path"===t&&(this._routeRegex=new s.Dom.Route.RegexPath(this.getAttribute("path")),this.refresh())}get routeRegex(){return this._routeRegex=this._routeRegex||new s.Dom.Route.RegexPath(this.getAttribute("path")),this._routeRegex}refresh(){const t=window.location.pathname,e=this.routeRegex.test(t);e.match?(this.activate(),this.state=e.data,this.$$("[data-sifrr-route-state=true]",!1).forEach(t=>{t.dataset.sifrrState=JSON.stringify({route:e.data})})):this.deactivate()}activate(){if(!this.loaded&&(this.loaded=!0,this.dataset.sifrrElements&&this.dataset.sifrrElements.indexOf("-")>0)){this.dataset.sifrrElements.split(",").filter((t,e,s)=>s.indexOf(t)===e).forEach(t=>{s.Dom.load(t)})}this.classList.add("active")}deactivate(){this.classList.remove("active")}static get currentUrl(){return this._curl}static set currentUrl(t){this._curl=t}static refreshAll(){window.location.href!==this.currentUrl&&(this.all.forEach(t=>{t.refresh()}),this.onRouteChange(),this.currentUrl=window.location.href)}static onRouteChange(){}}return a.all=[],s.Dom.Route.Element=a,s.Dom.register(a),document.addEventListener("click",t=>{if(!window.history||!window.history.pushState)return;const e=t.composedPath?t.composedPath()[0]:t.target;if(t.metaKey||t.ctrlKey)return;if(!e.matches("a"))return;if(e.host!==window.location.host)return;if(e.target&&"_self"!==e.target)return;t.preventDefault();const s=e.getAttribute("title")||i,r={location:e.pathname,title:s};document.title=s,window.history.pushState(r,s,e.pathname),a.refreshAll()}),window.addEventListener("popstate",t=>{t.state&&t.state.title?document.title=t.state.title:document.title=i,a.refreshAll()}),a});
/*! (c) @aadityataparia */
//# sourceMappingURL=sifrr.route.min.js.map
