/*! Sifrr.Route v0.0.3 - sifrr project | MIT licensed | https://github.com/sifrr/sifrr */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@sifrr/dom")):"function"==typeof define&&define.amd?define(["@sifrr/dom"],e):((t=t||self).Sifrr=t.Sifrr||{},t.Sifrr.Route=e(t.Sifrr.Dom))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e=class{constructor(t,e={}){this.options=Object.assign({delimiter:"/"},e),this.path=t}get regex(){return this._regex=this._regex||new RegExp("^"+this.path.replace(/\/:[A-Za-z0-9_]{0,}\?/g,"(/[^/]{0,})?").replace(/\*\*/g,"(.{0,})").replace(/\*/g,"([^/]{0,})").replace(/:[A-Za-z0-9_]{0,}/g,"([^/]{0,})")+"$"),this._regex}get dataMap(){return this._dataMap?this._dataMap:(this._dataMap=[],this.path.split("/").forEach(t=>{":"===t[0]?this._dataMap.push(t):("*"===t||"**"===t||t.match(/\(.*\)/))&&this._dataMap.push(t)}),this._dataMap)}test(t){const e={},i=this.regex.exec(t);return i&&this.dataMap.forEach((t,s)=>{"*"===t?(e["*"]=e["*"]||[],e["*"].push(i[s+1])):"**"===t?(e["**"]=e["**"]||[],e["**"].push(i[s+1])):":"===t[0]?e[t.substr(1)]=i[s+1]:(e.regexGroups=e.regexGroups||[],e.regexGroups.push(i[s+1]))}),{match:!!i,data:e}}};window.Sifrr=window.Sifrr||{},window.Sifrr.Dom=window.Sifrr.Dom||t;const i=window.Sifrr;i.Dom.Route={RegexPath:e};const s=window.document.title;class r extends i.Dom.Element{static get template(){return i.Dom.template("<style>:host{display: none;}:host(.active){display: block;}</style><slot></slot>")}static observedAttrs(){return["path"]}onConnect(){this.loaded=!1,this.constructor.all.push(this)}onDisconnect(){this.constructor.all.splice(this.constructor.all.indexOf(this),1)}onAttributeChange(t){"path"===t&&(this._routeRegex=new i.Dom.Route.RegexPath(this.getAttribute("path")),this.refresh())}get routeRegex(){return this._routeRegex}refresh(){const t=window.location.pathname,e=this.routeRegex.test(t);e.match?(this.activate(),this.state=e.data,this.$$("[data-sifrr-route-state=true]",!1).forEach(t=>{t.state={route:e.data}})):this.deactivate()}activate(){if(!this.loaded&&(this.loaded=!0,this.dataset.sifrrElements&&this.dataset.sifrrElements.indexOf("-")>0)){this.dataset.sifrrElements.split(",").filter((t,e,i)=>i.indexOf(t)===e).forEach(t=>{i.Dom.load(t)})}this.classList.add("active"),this.onActivation()}onActivation(){}deactivate(){this.classList.remove("active"),this.onDeactivation()}onDeactivation(){}static get currentUrl(){return this._curl}static set currentUrl(t){this._curl=t}static refreshAll(){window.location.pathname!==this.currentUrl&&(this.all.forEach(t=>{t.refresh()}),this.onRouteChange(),this.currentUrl=window.location.pathname)}static onRouteChange(){}static clickEventListener(t){if(!window.history||!window.history.pushState)return!1;const e=t.composedPath?t.composedPath()[0]:t.target;if(t.metaKey||t.ctrlKey)return!1;if(!e.matches("a"))return!1;if(e.host!==window.location.host)return!1;if(e.target&&"_self"!==e.target)return!1;t.preventDefault();const i=e.getAttribute("title")||s,a={pathname:e.pathname,href:e.href,title:i};return window.document.title=i,window.history.pushState(a,i,e.href),r.refreshAll(),!0}static popstateEventListener(t){t.state&&t.state.title?window.document.title=t.state.title:window.document.title=s,r.refreshAll()}}return r.all=[],i.Dom.Route.Element=r,i.Dom.register(r),window.addEventListener("popstate",r.popstateEventListener),window.document.addEventListener("click",r.clickEventListener),r});
/*! (c) @aadityataparia */
//# sourceMappingURL=sifrr.route.min.js.map
