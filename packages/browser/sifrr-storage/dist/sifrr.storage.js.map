{"version":3,"file":"sifrr.storage.js","sources":["../src/utils/json.js","../src/storages/storage.js","../src/storages/indexeddb.js","../src/storages/websql.js","../src/storages/localstorage.js","../src/storages/cookies.js","../src/storages/jsonstorage.js","../src/storages.js","../src/sifrr.storage.js"],"sourcesContent":["const toS = Object.prototype.toString;\nconst uId = '~~SifrrStorage84l23g5k34~~';\n\nfunction decodeBlob(str, type) {\n  return new Blob([new window.Uint8Array(str.split(',')).buffer], { type });\n}\n\nfunction encodeBlob(blob) {\n  const uri = URL.createObjectURL(blob),\n    xhr = new XMLHttpRequest();\n\n  xhr.open('GET', uri, false);\n  xhr.send();\n\n  URL.revokeObjectURL(uri);\n\n  const ui8 = new Uint8Array(xhr.response.length);\n  for (let i = 0; i < xhr.response.length; ++i) {\n    ui8[i] = xhr.response.charCodeAt(i);\n  }\n  return ui8.toString();\n}\n\nclass Json {\n  static parse(data) {\n    let ans = data;\n    if (typeof data === 'string') {\n      try {\n        ans = data = JSON.parse(data);\n      } catch(e) {\n        // do nothing\n      }\n    }\n\n    if (typeof data === 'string') {\n      const i = data.indexOf(uId);\n      if (i > 0) {\n        const [type, av, av2] = data.split(uId);\n        if (type === 'ArrayBuffer') ans = new window.Uint8Array(av.split(',')).buffer;\n        else if (type === 'Blob') ans = decodeBlob(av2, av);\n        else ans = new window[type](av.split(','));\n      }\n    } else if (Array.isArray(data)) {\n      ans = [];\n      data.forEach((v, i) => {\n        ans[i] = this.parse(v);\n      });\n    } else if (typeof data === 'object') {\n      if (data === null) return null;\n      ans = {};\n      for (const k in data) {\n        ans[k] = this.parse(data[k]);\n      }\n    }\n    return ans;\n  }\n\n  static stringify(data) {\n    if (typeof data !== 'object') return JSON.stringify(data);\n    if (data === null) return 'null';\n    if (Array.isArray(data)) return JSON.stringify(data.map(d => this.stringify(d)));\n    const type = toS.call(data).slice(8, -1);\n    if (type === 'Object') {\n      let ans = {};\n      for (let k in data) {\n        ans[k] = this.stringify(data[k]);\n      }\n      return JSON.stringify(ans);\n    } else if (type === 'ArrayBuffer') {\n      data = new window.Uint8Array(data);\n    } else if (type === 'Blob') {\n      data = data.type + uId + encodeBlob(data);\n    }\n    return type + uId + data.toString();\n  }\n}\n\nmodule.exports = Json;\n","const JsonExt = require('../utils/json');\nconst jsonConstructor = {}.constructor;\n\nclass Storage {\n  constructor(options = {}) {\n    this._options = options;\n    this.name = this._options.name;\n    this.version = this._options.version;\n    this.tableName = this.name + this.version;\n    this.description = this._options.description;\n    this.type = this.constructor.type;\n  }\n\n  _parseKeyValue(key, value) {\n    if (typeof value === 'undefined') {\n      if (Array.isArray(key)) {\n        return key;\n      } else if (typeof key === 'string') {\n        return [key];\n      } else if (key.constructor === jsonConstructor) {\n        return key;\n      } {\n        throw Error('Invalid Key');\n      }\n    } else if (typeof key === 'string') {\n      let ans = {};\n      ans[key] = value;\n      return ans;\n    } else {\n      throw Error('Invalid Key');\n    }\n  }\n\n  _select(keys) {\n    return this.all().then((data) => {\n      let ans = {};\n      keys.forEach((key) => ans[key] = data[key]);\n      return ans;\n    });\n  }\n\n  _upsert(data) {\n    let table = this.table;\n    for (let key in data) {\n      table[key] = data[key];\n    }\n    this.table = table;\n  }\n\n  _delete(keys) {\n    let table = this.table;\n    keys.forEach((key) => delete table[key]);\n    this.table = table;\n  }\n\n  _clear() {\n    this.table = {};\n  }\n\n  _isEqual(options, type) {\n    if (this.tableName == options.name + options.version && this.type == type) { return true; }\n    else { return false; }\n  }\n\n  isSupported(force = true) {\n    if (force && (typeof window === 'undefined' || typeof document === 'undefined')) { return true; }\n    else if (window && typeof this.store !== 'undefined') { return true; }\n    else { return false; }\n  }\n\n  keys() {\n    return this.all().then(d => Object.keys(d));\n  }\n\n  all() {\n    return Promise.resolve(this._parsedData());\n  }\n\n  get(key) {\n    return Promise.resolve(this._select(this._parseKeyValue(key)));\n  }\n\n  set(key, value) {\n    return Promise.resolve(this._upsert(this._parseKeyValue(key, value)));\n  }\n\n  del(key) {\n    return Promise.resolve(this._delete(this._parseKeyValue(key)));\n  }\n\n  clear() {\n    return Promise.resolve(this._clear());\n  }\n\n  static stringify(data) {\n    return JsonExt.stringify(data);\n  }\n\n  static parse(data) {\n    return JsonExt.parse(data);\n  }\n}\n\nmodule.exports = Storage;\n","const Storage = require('./storage');\n\nclass IndexedDB extends Storage {\n  constructor(options) {\n    super(options);\n  }\n\n  _parsedData() {\n    return this._tx('readonly', 'getAllKeys').then(this._select.bind(this));\n  }\n\n  _select(keys) {\n    const ans = {};\n    const promises = [];\n    keys.forEach((key) => promises.push(this._tx('readonly', 'get', key).then((r) => ans[key] = r)));\n    return Promise.all(promises).then(() => ans);\n  }\n\n  _upsert(data) {\n    const promises = [];\n    for (let key in data) promises.push(this._tx('readwrite', 'put', data[key], key));\n    return Promise.all(promises);\n  }\n\n  _delete(keys) {\n    const promises = [];\n    keys.forEach((key) => promises.push(this._tx('readwrite', 'delete', key)));\n    return Promise.all(promises);\n  }\n\n  _clear() {\n    return this._tx('readwrite', 'clear');\n  }\n\n  _tx(scope, fn, param1, param2) {\n    const me = this;\n    this._store = this._store || this.createStore(me.tableName);\n    return this._store.then((db) => {\n      return new Promise((resolve, reject) => {\n        const tx = db.transaction(me.tableName, scope).objectStore(me.tableName);\n        const request = tx[fn].call(tx, param1, param2);\n        request.onsuccess = (event) =>  resolve(event.target.result);\n        request.onerror = (event) => reject(event.error);\n      });\n    });\n  }\n\n  get store() {\n    return window.indexedDB;\n  }\n\n  createStore(table) {\n    return new Promise((resolve, reject) => {\n      const request = this.store.open(table, 1);\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        db.createObjectStore(table);\n      };\n      request.onsuccess = () => resolve(request.result);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  static get type() {\n    return 'indexeddb';\n  }\n}\n\nmodule.exports = IndexedDB;\n","const Storage = require('./storage');\n\nclass WebSQL extends Storage {\n  constructor(options) {\n    super(options);\n    this.createStore();\n  }\n\n  _parsedData() {\n    const me = this;\n    return new Promise((resolve) => {\n      this.store.transaction(function (tx) {\n        tx.executeSql(`SELECT * FROM ${me.tableName}`, [], (txn, results) => {\n          resolve(me.parse(results));\n        });\n      });\n    });\n  }\n\n  _select(keys) {\n    const me = this;\n    const q = keys.map(() => '?').join(', ');\n    // Need to give array for ? values in executeSql's 2nd argument\n    return this.execSql(`SELECT key, value FROM ${me.tableName} WHERE key in (${q})`, keys);\n  }\n\n  _upsert(data) {\n    const table = this.tableName;\n    this.store.transaction((tx) => {\n      for (let key in data) {\n        tx.executeSql(`INSERT OR REPLACE INTO ${table}(key, value) VALUES (?, ?)`, [key, this.constructor.stringify(data[key])]);\n      }\n    });\n  }\n\n  _delete(keys) {\n    const table = this.tableName;\n    const q = keys.map(() => '?').join(', ');\n    return this.execSql(`DELETE FROM ${table} WHERE key in (${q})`, keys);\n  }\n\n  _clear() {\n    const table = this.tableName;\n    return this.execSql(`DELETE FROM ${table}`);\n  }\n\n  get store() {\n    return window.openDatabase('bs', 1, this._options.description, this._options.size);\n  }\n\n  createStore() {\n    const table = this.tableName;\n    if (!window || typeof window.openDatabase !== 'function') return;\n    return this.execSql(`CREATE TABLE IF NOT EXISTS ${table} (key unique, value)`);\n  }\n\n  execSql(query, args = []) {\n    const me = this;\n    return new Promise((resolve) => {\n      me.store.transaction(function (tx) {\n        tx.executeSql(query, args, (txn, results) => {\n          resolve(me.parse(results));\n        });\n      });\n    });\n  }\n\n  parse(results) {\n    const ans = {};\n    const len = results.rows.length;\n    for (let i = 0; i < len; i++) {\n      ans[results.rows.item(i).key] = this.constructor.parse(results.rows.item(i).value);\n    }\n    return ans;\n  }\n\n  static get type() {\n    return 'websql';\n  }\n}\n\nmodule.exports = WebSQL;\n","const Storage = require('./storage');\n\nclass LocalStorage extends Storage {\n  constructor(options) {\n    super(options);\n  }\n\n  _parsedData() {\n    return this.table;\n  }\n\n  _select(keys) {\n    const table = {};\n    keys.forEach(k => {\n      const v = this.constructor.parse(this.store.getItem(this.tableName + '/' + k));\n      if (v !== null) table[k] = v;\n    });\n    return table;\n  }\n\n  _upsert(data) {\n    for (let key in data) {\n      this.store.setItem(this.tableName + '/' + key, this.constructor.stringify(data[key]));\n    }\n    return true;\n  }\n\n  _delete(keys) {\n    return keys.map(k => this.store.removeItem(this.tableName + '/' + k));\n  }\n\n  _clear() {\n    Object.keys(this.store).forEach(k => {\n      if (k.indexOf(this.tableName) === 0) this.store.removeItem(k);\n    });\n    return true;\n  }\n\n  get table() {\n    return this._select(Object.keys(this.store).map(k => {\n      if (k.indexOf(this.tableName) === 0) return k.slice(this.tableName.length + 1);\n    }).filter(k => typeof k !== 'undefined'));\n  }\n\n  get store() {\n    return window.localStorage;\n  }\n\n  static get type() {\n    return 'localstorage';\n  }\n}\n\nmodule.exports = LocalStorage;\n","const Storage = require('./storage');\nconst date = new Date(0).toUTCString();\nconst equal = '%3D', equalRegex = new RegExp(equal, 'g');\n\nclass Cookies extends Storage {\n  constructor(options) {\n    super(options);\n  }\n\n  _parsedData() {\n    let result = this.store, ans = {};\n    result.split('; ').forEach((value) => {\n      let [k, v] = value.split('=');\n      if (k.indexOf(this.tableName) === 0) ans[k.slice(this.tableName.length + 1)] = this.constructor.parse(v.replace(equalRegex, '='));\n    });\n    return ans;\n  }\n\n  _upsert(data) {\n    for (let key in data) {\n      this.store = `${this.tableName}/${key}=${this.constructor.stringify(data[key]).replace(/=/g, equal)}; path=/`;\n    }\n    return true;\n  }\n\n  _clear() {\n    let result = this.store;\n    result.split('; ').forEach((value) => {\n      const k = value.split('=')[0];\n      if (k.indexOf(this.tableName) === 0) {\n        this.store = `${k}=; expires=${date}; path=/`;\n      }\n    });\n  }\n\n  get store() {\n    return document.cookie;\n  }\n\n  set store(v) {\n    document.cookie = v;\n  }\n\n  static get type() {\n    return 'cookies';\n  }\n}\n\nmodule.exports = Cookies;\n","const Storage = require('./storage');\n\nclass JsonStorage extends Storage {\n  constructor(options, data = {}) {\n    super(options);\n    this.table = Storage.parse(data);\n  }\n\n  _parsedData() {\n    return this.table;\n  }\n\n  _upsert(data) {\n    for (let key in data) {\n      this.table[key] = data[key];\n    }\n  }\n\n  get store() {\n    return this.table;\n  }\n\n  static get type() {\n    return 'jsonstorage';\n  }\n}\n\nmodule.exports = JsonStorage;\n","const IndexedDB = require('./storages/indexeddb');\nconst WebSQL = require('./storages/websql');\nconst LocalStorage = require('./storages/localstorage');\nconst Cookies = require('./storages/cookies');\nconst JsonStorage = require('./storages/jsonstorage');\n\nlet storages = {};\nstorages[IndexedDB.type] = IndexedDB;\nstorages[WebSQL.type] = WebSQL;\nstorages[LocalStorage.type] = LocalStorage;\nstorages[Cookies.type] = Cookies;\nstorages[JsonStorage.type] = JsonStorage;\n\nmodule.exports = storages;\n","const storages = require('./storages');\nconst JsonStorage = require('./storages/jsonstorage');\n\nclass SifrrStorage {\n  constructor(options) {\n    if (typeof options === 'string') options = { priority: [options] }; else options = options || {};\n    this._options = Object.assign(this.constructor.defaultOptions, options);\n    return this.storage;\n  }\n\n  get storage() {\n    let storage = this.supportedStore();\n    if (typeof storage === 'undefined') throw Error('No available storage supported in this browser');\n    let matchingInstance = this.constructor._matchingInstance(this._options, storage.type);\n    if (matchingInstance) { return matchingInstance; }\n    else {\n      let storageInstance = new storage(this._options);\n      this.constructor._add(storageInstance);\n      return storageInstance;\n    }\n  }\n\n  get priority() {\n    return this._options.priority.concat(['indexeddb', 'websql', 'localstorage', 'cookies', 'jsonstorage']);\n  }\n\n  supportedStore() {\n    for (let i = 0; i < this.priority.length; i++) {\n      let store = this.constructor.availableStores[this.priority[i]];\n      if (store && new store(this._options).isSupported()) return store;\n    }\n  }\n\n  static _matchingInstance(options, type) {\n    let allInstances = this.all, i;\n    let length = allInstances.length;\n    for (i = 0; i < length; i++) {\n      if (allInstances[i]._isEqual(options, type)) return allInstances[i];\n    }\n    return false;\n  }\n\n  static _add(instance) {\n    this.all.push(instance);\n  }\n\n  static get defaultOptions() {\n    return {\n      priority: [],\n      name: 'SifrrStorage',\n      version: 1,\n      description: 'Sifrr Storage',\n      size: 5 * 1024 * 1024\n    };\n  }\n\n  static json(data) {\n    return new JsonStorage({}, data);\n  }\n}\n\nSifrrStorage.availableStores = storages;\nSifrrStorage.all = [];\n\nmodule.exports = SifrrStorage;\n"],"names":["toS","Object","prototype","toString","uId","decodeBlob","str","type","Blob","window","Uint8Array","split","buffer","encodeBlob","blob","uri","URL","createObjectURL","xhr","XMLHttpRequest","open","send","revokeObjectURL","ui8","response","length","i","charCodeAt","Json","parse","data","ans","JSON","e","indexOf","av","av2","Array","isArray","forEach","v","k","stringify","map","d","call","slice","jsonConstructor","constructor","Storage","options","_options","name","version","tableName","description","_parseKeyValue","key","value","Error","_select","keys","all","then","_upsert","table","_delete","_clear","_isEqual","isSupported","force","document","store","Promise","resolve","_parsedData","get","set","del","clear","JsonExt","IndexedDB","_tx","bind","promises","push","r","scope","fn","param1","param2","me","_store","createStore","db","reject","tx","transaction","objectStore","request","onsuccess","event","target","result","onerror","error","indexedDB","onupgradeneeded","createObjectStore","WebSQL","executeSql","txn","results","q","join","execSql","openDatabase","size","query","args","len","rows","item","LocalStorage","getItem","setItem","removeItem","filter","localStorage","date","Date","toUTCString","equal","equalRegex","RegExp","Cookies","replace","cookie","JsonStorage","storages","SifrrStorage","priority","assign","defaultOptions","storage","supportedStore","matchingInstance","_matchingInstance","storageInstance","_add","concat","availableStores","allInstances","instance","json"],"mappings":";;;;;;;EAAA,MAAMA,GAAG,GAAGC,MAAM,CAACC,SAAP,CAAiBC,QAA7B;EACA,MAAMC,GAAG,GAAG,4BAAZ;EAEA,SAASC,UAAT,CAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;EAC7B,SAAO,IAAIC,IAAJ,CAAS,CAAC,IAAIC,MAAM,CAACC,UAAX,CAAsBJ,GAAG,CAACK,KAAJ,CAAU,GAAV,CAAtB,EAAsCC,MAAvC,CAAT,EAAyD;EAAEL,IAAAA;EAAF,GAAzD,CAAP;EACD;EAED,SAASM,UAAT,CAAoBC,IAApB,EAA0B;EACxB,QAAMC,GAAG,GAAGC,GAAG,CAACC,eAAJ,CAAoBH,IAApB,CAAZ;EAAA,QACEI,GAAG,GAAG,IAAIC,cAAJ,EADR;EAGAD,EAAAA,GAAG,CAACE,IAAJ,CAAS,KAAT,EAAgBL,GAAhB,EAAqB,KAArB;EACAG,EAAAA,GAAG,CAACG,IAAJ;EAEAL,EAAAA,GAAG,CAACM,eAAJ,CAAoBP,GAApB;EAEA,QAAMQ,GAAG,GAAG,IAAIb,UAAJ,CAAeQ,GAAG,CAACM,QAAJ,CAAaC,MAA5B,CAAZ;EACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,GAAG,CAACM,QAAJ,CAAaC,MAAjC,EAAyC,EAAEC,CAA3C,EAA8C;EAC5CH,IAAAA,GAAG,CAACG,CAAD,CAAH,GAASR,GAAG,CAACM,QAAJ,CAAaG,UAAb,CAAwBD,CAAxB,CAAT;EACD;EACD,SAAOH,GAAG,CAACpB,QAAJ,EAAP;EACD;EAED,MAAMyB,IAAN,CAAW;EACT,SAAOC,KAAP,CAAaC,IAAb,EAAmB;EACjB,QAAIC,GAAG,GAAGD,IAAV;EACA,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;EAC5B,UAAI;EACFC,QAAAA,GAAG,GAAGD,IAAI,GAAGE,IAAI,CAACH,KAAL,CAAWC,IAAX,CAAb;EACD,OAFD,CAEE,OAAMG,CAAN,EAAS;EAEV;EACF;EAED,QAAI,OAAOH,IAAP,KAAgB,QAApB,EAA8B;EAC5B,YAAMJ,CAAC,GAAGI,IAAI,CAACI,OAAL,CAAa9B,GAAb,CAAV;EACA,UAAIsB,CAAC,GAAG,CAAR,EAAW;EACT,cAAM,CAACnB,IAAD,EAAO4B,EAAP,EAAWC,GAAX,IAAkBN,IAAI,CAACnB,KAAL,CAAWP,GAAX,CAAxB;EACA,YAAIG,IAAI,KAAK,aAAb,EAA4BwB,GAAG,GAAG,IAAItB,MAAM,CAACC,UAAX,CAAsByB,EAAE,CAACxB,KAAH,CAAS,GAAT,CAAtB,EAAqCC,MAA3C,CAA5B,KACK,IAAIL,IAAI,KAAK,MAAb,EAAqBwB,GAAG,GAAG1B,UAAU,CAAC+B,GAAD,EAAMD,EAAN,CAAhB,CAArB,KACAJ,GAAG,GAAG,IAAItB,MAAM,CAACF,IAAD,CAAV,CAAiB4B,EAAE,CAACxB,KAAH,CAAS,GAAT,CAAjB,CAAN;EACN;EACF,KARD,MAQO,IAAI0B,KAAK,CAACC,OAAN,CAAcR,IAAd,CAAJ,EAAyB;EAC9BC,MAAAA,GAAG,GAAG,EAAN;EACAD,MAAAA,IAAI,CAACS,OAAL,CAAa,CAACC,CAAD,EAAId,CAAJ,KAAU;EACrBK,QAAAA,GAAG,CAACL,CAAD,CAAH,GAAS,KAAKG,KAAL,CAAWW,CAAX,CAAT;EACD,OAFD;EAGD,KALM,MAKA,IAAI,OAAOV,IAAP,KAAgB,QAApB,EAA8B;EACnC,UAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,IAAP;EACnBC,MAAAA,GAAG,GAAG,EAAN;EACA,WAAK,MAAMU,CAAX,IAAgBX,IAAhB,EAAsB;EACpBC,QAAAA,GAAG,CAACU,CAAD,CAAH,GAAS,KAAKZ,KAAL,CAAWC,IAAI,CAACW,CAAD,CAAf,CAAT;EACD;EACF;EACD,WAAOV,GAAP;EACD;EAED,SAAOW,SAAP,CAAiBZ,IAAjB,EAAuB;EACrB,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B,OAAOE,IAAI,CAACU,SAAL,CAAeZ,IAAf,CAAP;EAC9B,QAAIA,IAAI,KAAK,IAAb,EAAmB,OAAO,MAAP;EACnB,QAAIO,KAAK,CAACC,OAAN,CAAcR,IAAd,CAAJ,EAAyB,OAAOE,IAAI,CAACU,SAAL,CAAeZ,IAAI,CAACa,GAAL,CAASC,CAAC,IAAI,KAAKF,SAAL,CAAeE,CAAf,CAAd,CAAf,CAAP;EACzB,UAAMrC,IAAI,GAAGP,GAAG,CAAC6C,IAAJ,CAASf,IAAT,EAAegB,KAAf,CAAqB,CAArB,EAAwB,CAAC,CAAzB,CAAb;EACA,QAAIvC,IAAI,KAAK,QAAb,EAAuB;EACrB,UAAIwB,GAAG,GAAG,EAAV;EACA,WAAK,IAAIU,CAAT,IAAcX,IAAd,EAAoB;EAClBC,QAAAA,GAAG,CAACU,CAAD,CAAH,GAAS,KAAKC,SAAL,CAAeZ,IAAI,CAACW,CAAD,CAAnB,CAAT;EACD;EACD,aAAOT,IAAI,CAACU,SAAL,CAAeX,GAAf,CAAP;EACD,KAND,MAMO,IAAIxB,IAAI,KAAK,aAAb,EAA4B;EACjCuB,MAAAA,IAAI,GAAG,IAAIrB,MAAM,CAACC,UAAX,CAAsBoB,IAAtB,CAAP;EACD,KAFM,MAEA,IAAIvB,IAAI,KAAK,MAAb,EAAqB;EAC1BuB,MAAAA,IAAI,GAAGA,IAAI,CAACvB,IAAL,GAAYH,GAAZ,GAAkBS,UAAU,CAACiB,IAAD,CAAnC;EACD;EACD,WAAOvB,IAAI,GAAGH,GAAP,GAAa0B,IAAI,CAAC3B,QAAL,EAApB;EACD;EAnDQ;EAsDX,QAAc,GAAGyB,IAAjB;;EC5EA,MAAMmB,eAAe,GAAG,GAAGC,WAA3B;EAEA,MAAMC,OAAN,CAAc;EACZD,EAAAA,WAAW,CAACE,OAAO,GAAG,EAAX,EAAe;EACxB,SAAKC,QAAL,GAAgBD,OAAhB;EACA,SAAKE,IAAL,GAAY,KAAKD,QAAL,CAAcC,IAA1B;EACA,SAAKC,OAAL,GAAe,KAAKF,QAAL,CAAcE,OAA7B;EACA,SAAKC,SAAL,GAAiB,KAAKF,IAAL,GAAY,KAAKC,OAAlC;EACA,SAAKE,WAAL,GAAmB,KAAKJ,QAAL,CAAcI,WAAjC;EACA,SAAKhD,IAAL,GAAY,KAAKyC,WAAL,CAAiBzC,IAA7B;EACD;EAEDiD,EAAAA,cAAc,CAACC,GAAD,EAAMC,KAAN,EAAa;EACzB,QAAI,OAAOA,KAAP,KAAiB,WAArB,EAAkC;EAChC,UAAIrB,KAAK,CAACC,OAAN,CAAcmB,GAAd,CAAJ,EAAwB;EACtB,eAAOA,GAAP;EACD,OAFD,MAEO,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;EAClC,eAAO,CAACA,GAAD,CAAP;EACD,OAFM,MAEA,IAAIA,GAAG,CAACT,WAAJ,KAAoBD,eAAxB,EAAyC;EAC9C,eAAOU,GAAP;EACD;EAAC;EACA,cAAME,KAAK,CAAC,aAAD,CAAX;EACD;EACF,KAVD,MAUO,IAAI,OAAOF,GAAP,KAAe,QAAnB,EAA6B;EAClC,UAAI1B,GAAG,GAAG,EAAV;EACAA,MAAAA,GAAG,CAAC0B,GAAD,CAAH,GAAWC,KAAX;EACA,aAAO3B,GAAP;EACD,KAJM,MAIA;EACL,YAAM4B,KAAK,CAAC,aAAD,CAAX;EACD;EACF;EAEDC,EAAAA,OAAO,CAACC,IAAD,EAAO;EACZ,WAAO,KAAKC,GAAL,GAAWC,IAAX,CAAiBjC,IAAD,IAAU;EAC/B,UAAIC,GAAG,GAAG,EAAV;EACA8B,MAAAA,IAAI,CAACtB,OAAL,CAAckB,GAAD,IAAS1B,GAAG,CAAC0B,GAAD,CAAH,GAAW3B,IAAI,CAAC2B,GAAD,CAArC;EACA,aAAO1B,GAAP;EACD,KAJM,CAAP;EAKD;EAEDiC,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,QAAImC,KAAK,GAAG,KAAKA,KAAjB;EACA,SAAK,IAAIR,GAAT,IAAgB3B,IAAhB,EAAsB;EACpBmC,MAAAA,KAAK,CAACR,GAAD,CAAL,GAAa3B,IAAI,CAAC2B,GAAD,CAAjB;EACD;EACD,SAAKQ,KAAL,GAAaA,KAAb;EACD;EAEDC,EAAAA,OAAO,CAACL,IAAD,EAAO;EACZ,QAAII,KAAK,GAAG,KAAKA,KAAjB;EACAJ,IAAAA,IAAI,CAACtB,OAAL,CAAckB,GAAD,IAAS,OAAOQ,KAAK,CAACR,GAAD,CAAlC;EACA,SAAKQ,KAAL,GAAaA,KAAb;EACD;EAEDE,EAAAA,MAAM,GAAG;EACP,SAAKF,KAAL,GAAa,EAAb;EACD;EAEDG,EAAAA,QAAQ,CAAClB,OAAD,EAAU3C,IAAV,EAAgB;EACtB,QAAI,KAAK+C,SAAL,IAAkBJ,OAAO,CAACE,IAAR,GAAeF,OAAO,CAACG,OAAzC,IAAoD,KAAK9C,IAAL,IAAaA,IAArE,EAA2E;EAAE,aAAO,IAAP;EAAc,KAA3F,MACK;EAAE,aAAO,KAAP;EAAe;EACvB;EAED8D,EAAAA,WAAW,CAACC,KAAK,GAAG,IAAT,EAAe;EACxB,QAAIA,KAAK,KAAK,OAAO7D,MAAP,KAAkB,WAAlB,IAAiC,OAAO8D,QAAP,KAAoB,WAA1D,CAAT,EAAiF;EAAE,aAAO,IAAP;EAAc,KAAjG,MACK,IAAI9D,MAAM,IAAI,OAAO,KAAK+D,KAAZ,KAAsB,WAApC,EAAiD;EAAE,aAAO,IAAP;EAAc,KAAjE,MACA;EAAE,aAAO,KAAP;EAAe;EACvB;EAEDX,EAAAA,IAAI,GAAG;EACL,WAAO,KAAKC,GAAL,GAAWC,IAAX,CAAgBnB,CAAC,IAAI3C,MAAM,CAAC4D,IAAP,CAAYjB,CAAZ,CAArB,CAAP;EACD;EAEDkB,EAAAA,GAAG,GAAG;EACJ,WAAOW,OAAO,CAACC,OAAR,CAAgB,KAAKC,WAAL,EAAhB,CAAP;EACD;EAEDC,EAAAA,GAAG,CAACnB,GAAD,EAAM;EACP,WAAOgB,OAAO,CAACC,OAAR,CAAgB,KAAKd,OAAL,CAAa,KAAKJ,cAAL,CAAoBC,GAApB,CAAb,CAAhB,CAAP;EACD;EAEDoB,EAAAA,GAAG,CAACpB,GAAD,EAAMC,KAAN,EAAa;EACd,WAAOe,OAAO,CAACC,OAAR,CAAgB,KAAKV,OAAL,CAAa,KAAKR,cAAL,CAAoBC,GAApB,EAAyBC,KAAzB,CAAb,CAAhB,CAAP;EACD;EAEDoB,EAAAA,GAAG,CAACrB,GAAD,EAAM;EACP,WAAOgB,OAAO,CAACC,OAAR,CAAgB,KAAKR,OAAL,CAAa,KAAKV,cAAL,CAAoBC,GAApB,CAAb,CAAhB,CAAP;EACD;EAEDsB,EAAAA,KAAK,GAAG;EACN,WAAON,OAAO,CAACC,OAAR,CAAgB,KAAKP,MAAL,EAAhB,CAAP;EACD;EAED,SAAOzB,SAAP,CAAiBZ,IAAjB,EAAuB;EACrB,WAAOkD,IAAO,CAACtC,SAAR,CAAkBZ,IAAlB,CAAP;EACD;EAED,SAAOD,KAAP,CAAaC,IAAb,EAAmB;EACjB,WAAOkD,IAAO,CAACnD,KAAR,CAAcC,IAAd,CAAP;EACD;EAjGW;EAoGd,WAAc,GAAGmB,OAAjB;;ECrGA,MAAMgC,SAAN,SAAwBhC,OAAxB,CAAgC;EAC9BD,EAAAA,WAAW,CAACE,OAAD,EAAU;EACnB,UAAMA,OAAN;EACD;EAEDyB,EAAAA,WAAW,GAAG;EACZ,WAAO,KAAKO,GAAL,CAAS,UAAT,EAAqB,YAArB,EAAmCnB,IAAnC,CAAwC,KAAKH,OAAL,CAAauB,IAAb,CAAkB,IAAlB,CAAxC,CAAP;EACD;EAEDvB,EAAAA,OAAO,CAACC,IAAD,EAAO;EACZ,UAAM9B,GAAG,GAAG,EAAZ;EACA,UAAMqD,QAAQ,GAAG,EAAjB;EACAvB,IAAAA,IAAI,CAACtB,OAAL,CAAckB,GAAD,IAAS2B,QAAQ,CAACC,IAAT,CAAc,KAAKH,GAAL,CAAS,UAAT,EAAqB,KAArB,EAA4BzB,GAA5B,EAAiCM,IAAjC,CAAuCuB,CAAD,IAAOvD,GAAG,CAAC0B,GAAD,CAAH,GAAW6B,CAAxD,CAAd,CAAtB;EACA,WAAOb,OAAO,CAACX,GAAR,CAAYsB,QAAZ,EAAsBrB,IAAtB,CAA2B,MAAMhC,GAAjC,CAAP;EACD;EAEDiC,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,UAAMsD,QAAQ,GAAG,EAAjB;EACA,SAAK,IAAI3B,GAAT,IAAgB3B,IAAhB,EAAsBsD,QAAQ,CAACC,IAAT,CAAc,KAAKH,GAAL,CAAS,WAAT,EAAsB,KAAtB,EAA6BpD,IAAI,CAAC2B,GAAD,CAAjC,EAAwCA,GAAxC,CAAd;EACtB,WAAOgB,OAAO,CAACX,GAAR,CAAYsB,QAAZ,CAAP;EACD;EAEDlB,EAAAA,OAAO,CAACL,IAAD,EAAO;EACZ,UAAMuB,QAAQ,GAAG,EAAjB;EACAvB,IAAAA,IAAI,CAACtB,OAAL,CAAckB,GAAD,IAAS2B,QAAQ,CAACC,IAAT,CAAc,KAAKH,GAAL,CAAS,WAAT,EAAsB,QAAtB,EAAgCzB,GAAhC,CAAd,CAAtB;EACA,WAAOgB,OAAO,CAACX,GAAR,CAAYsB,QAAZ,CAAP;EACD;EAEDjB,EAAAA,MAAM,GAAG;EACP,WAAO,KAAKe,GAAL,CAAS,WAAT,EAAsB,OAAtB,CAAP;EACD;EAEDA,EAAAA,GAAG,CAACK,KAAD,EAAQC,EAAR,EAAYC,MAAZ,EAAoBC,MAApB,EAA4B;EAC7B,UAAMC,EAAE,GAAG,IAAX;EACA,SAAKC,MAAL,GAAc,KAAKA,MAAL,IAAe,KAAKC,WAAL,CAAiBF,EAAE,CAACrC,SAApB,CAA7B;EACA,WAAO,KAAKsC,MAAL,CAAY7B,IAAZ,CAAkB+B,EAAD,IAAQ;EAC9B,aAAO,IAAIrB,OAAJ,CAAY,CAACC,OAAD,EAAUqB,MAAV,KAAqB;EACtC,cAAMC,EAAE,GAAGF,EAAE,CAACG,WAAH,CAAeN,EAAE,CAACrC,SAAlB,EAA6BiC,KAA7B,EAAoCW,WAApC,CAAgDP,EAAE,CAACrC,SAAnD,CAAX;EACA,cAAM6C,OAAO,GAAGH,EAAE,CAACR,EAAD,CAAF,CAAO3C,IAAP,CAAYmD,EAAZ,EAAgBP,MAAhB,EAAwBC,MAAxB,CAAhB;EACAS,QAAAA,OAAO,CAACC,SAAR,GAAqBC,KAAD,IAAY3B,OAAO,CAAC2B,KAAK,CAACC,MAAN,CAAaC,MAAd,CAAvC;EACAJ,QAAAA,OAAO,CAACK,OAAR,GAAmBH,KAAD,IAAWN,MAAM,CAACM,KAAK,CAACI,KAAP,CAAnC;EACD,OALM,CAAP;EAMD,KAPM,CAAP;EAQD;EAED,MAAIjC,KAAJ,GAAY;EACV,WAAO/D,MAAM,CAACiG,SAAd;EACD;EAEDb,EAAAA,WAAW,CAAC5B,KAAD,EAAQ;EACjB,WAAO,IAAIQ,OAAJ,CAAY,CAACC,OAAD,EAAUqB,MAAV,KAAqB;EACtC,YAAMI,OAAO,GAAG,KAAK3B,KAAL,CAAWpD,IAAX,CAAgB6C,KAAhB,EAAuB,CAAvB,CAAhB;EACAkC,MAAAA,OAAO,CAACQ,eAAR,GAA2BN,KAAD,IAAW;EACnC,cAAMP,EAAE,GAAGO,KAAK,CAACC,MAAN,CAAaC,MAAxB;EACAT,QAAAA,EAAE,CAACc,iBAAH,CAAqB3C,KAArB;EACD,OAHD;EAIAkC,MAAAA,OAAO,CAACC,SAAR,GAAoB,MAAM1B,OAAO,CAACyB,OAAO,CAACI,MAAT,CAAjC;EACAJ,MAAAA,OAAO,CAACK,OAAR,GAAkB,MAAMT,MAAM,CAACI,OAAO,CAACM,KAAT,CAA9B;EACD,KARM,CAAP;EASD;EAED,aAAWlG,IAAX,GAAkB;EAChB,WAAO,WAAP;EACD;EA/D6B;EAkEhC,aAAc,GAAG0E,SAAjB;;EClEA,MAAM4B,MAAN,SAAqB5D,OAArB,CAA6B;EAC3BD,EAAAA,WAAW,CAACE,OAAD,EAAU;EACnB,UAAMA,OAAN;EACA,SAAK2C,WAAL;EACD;EAEDlB,EAAAA,WAAW,GAAG;EACZ,UAAMgB,EAAE,GAAG,IAAX;EACA,WAAO,IAAIlB,OAAJ,CAAaC,OAAD,IAAa;EAC9B,WAAKF,KAAL,CAAWyB,WAAX,CAAuB,UAAUD,EAAV,EAAc;EACnCA,QAAAA,EAAE,CAACc,UAAH,yBAA+BnB,EAAE,CAACrC,SAAlC,GAA+C,EAA/C,EAAmD,CAACyD,GAAD,EAAMC,OAAN,KAAkB;EACnEtC,UAAAA,OAAO,CAACiB,EAAE,CAAC9D,KAAH,CAASmF,OAAT,CAAD,CAAP;EACD,SAFD;EAGD,OAJD;EAKD,KANM,CAAP;EAOD;EAEDpD,EAAAA,OAAO,CAACC,IAAD,EAAO;EACZ,UAAM8B,EAAE,GAAG,IAAX;EACA,UAAMsB,CAAC,GAAGpD,IAAI,CAAClB,GAAL,CAAS,MAAM,GAAf,EAAoBuE,IAApB,CAAyB,IAAzB,CAAV,CAFY;EAIZ,WAAO,KAAKC,OAAL,kCAAuCxB,EAAE,CAACrC,SAA1C,4BAAqE2D,CAArE,QAA2EpD,IAA3E,CAAP;EACD;EAEDG,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,UAAMmC,KAAK,GAAG,KAAKX,SAAnB;EACA,SAAKkB,KAAL,CAAWyB,WAAX,CAAwBD,EAAD,IAAQ;EAC7B,WAAK,IAAIvC,GAAT,IAAgB3B,IAAhB,EAAsB;EACpBkE,QAAAA,EAAE,CAACc,UAAH,kCAAwC7C,KAAxC,iCAA2E,CAACR,GAAD,EAAM,KAAKT,WAAL,CAAiBN,SAAjB,CAA2BZ,IAAI,CAAC2B,GAAD,CAA/B,CAAN,CAA3E;EACD;EACF,KAJD;EAKD;EAEDS,EAAAA,OAAO,CAACL,IAAD,EAAO;EACZ,UAAMI,KAAK,GAAG,KAAKX,SAAnB;EACA,UAAM2D,CAAC,GAAGpD,IAAI,CAAClB,GAAL,CAAS,MAAM,GAAf,EAAoBuE,IAApB,CAAyB,IAAzB,CAAV;EACA,WAAO,KAAKC,OAAL,uBAA4BlD,KAA5B,4BAAmDgD,CAAnD,QAAyDpD,IAAzD,CAAP;EACD;EAEDM,EAAAA,MAAM,GAAG;EACP,UAAMF,KAAK,GAAG,KAAKX,SAAnB;EACA,WAAO,KAAK6D,OAAL,uBAA4BlD,KAA5B,EAAP;EACD;EAED,MAAIO,KAAJ,GAAY;EACV,WAAO/D,MAAM,CAAC2G,YAAP,CAAoB,IAApB,EAA0B,CAA1B,EAA6B,KAAKjE,QAAL,CAAcI,WAA3C,EAAwD,KAAKJ,QAAL,CAAckE,IAAtE,CAAP;EACD;EAEDxB,EAAAA,WAAW,GAAG;EACZ,UAAM5B,KAAK,GAAG,KAAKX,SAAnB;EACA,QAAI,CAAC7C,MAAD,IAAW,OAAOA,MAAM,CAAC2G,YAAd,KAA+B,UAA9C,EAA0D;EAC1D,WAAO,KAAKD,OAAL,sCAA2ClD,KAA3C,0BAAP;EACD;EAEDkD,EAAAA,OAAO,CAACG,KAAD,EAAQC,IAAI,GAAG,EAAf,EAAmB;EACxB,UAAM5B,EAAE,GAAG,IAAX;EACA,WAAO,IAAIlB,OAAJ,CAAaC,OAAD,IAAa;EAC9BiB,MAAAA,EAAE,CAACnB,KAAH,CAASyB,WAAT,CAAqB,UAAUD,EAAV,EAAc;EACjCA,QAAAA,EAAE,CAACc,UAAH,CAAcQ,KAAd,EAAqBC,IAArB,EAA2B,CAACR,GAAD,EAAMC,OAAN,KAAkB;EAC3CtC,UAAAA,OAAO,CAACiB,EAAE,CAAC9D,KAAH,CAASmF,OAAT,CAAD,CAAP;EACD,SAFD;EAGD,OAJD;EAKD,KANM,CAAP;EAOD;EAEDnF,EAAAA,KAAK,CAACmF,OAAD,EAAU;EACb,UAAMjF,GAAG,GAAG,EAAZ;EACA,UAAMyF,GAAG,GAAGR,OAAO,CAACS,IAAR,CAAahG,MAAzB;EACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8F,GAApB,EAAyB9F,CAAC,EAA1B,EAA8B;EAC5BK,MAAAA,GAAG,CAACiF,OAAO,CAACS,IAAR,CAAaC,IAAb,CAAkBhG,CAAlB,EAAqB+B,GAAtB,CAAH,GAAgC,KAAKT,WAAL,CAAiBnB,KAAjB,CAAuBmF,OAAO,CAACS,IAAR,CAAaC,IAAb,CAAkBhG,CAAlB,EAAqBgC,KAA5C,CAAhC;EACD;EACD,WAAO3B,GAAP;EACD;EAED,aAAWxB,IAAX,GAAkB;EAChB,WAAO,QAAP;EACD;EA5E0B;EA+E7B,UAAc,GAAGsG,MAAjB;;EC/EA,MAAMc,YAAN,SAA2B1E,OAA3B,CAAmC;EACjCD,EAAAA,WAAW,CAACE,OAAD,EAAU;EACnB,UAAMA,OAAN;EACD;EAEDyB,EAAAA,WAAW,GAAG;EACZ,WAAO,KAAKV,KAAZ;EACD;EAEDL,EAAAA,OAAO,CAACC,IAAD,EAAO;EACZ,UAAMI,KAAK,GAAG,EAAd;EACAJ,IAAAA,IAAI,CAACtB,OAAL,CAAaE,CAAC,IAAI;EAChB,YAAMD,CAAC,GAAG,KAAKQ,WAAL,CAAiBnB,KAAjB,CAAuB,KAAK2C,KAAL,CAAWoD,OAAX,CAAmB,KAAKtE,SAAL,GAAiB,GAAjB,GAAuBb,CAA1C,CAAvB,CAAV;EACA,UAAID,CAAC,KAAK,IAAV,EAAgByB,KAAK,CAACxB,CAAD,CAAL,GAAWD,CAAX;EACjB,KAHD;EAIA,WAAOyB,KAAP;EACD;EAEDD,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,SAAK,IAAI2B,GAAT,IAAgB3B,IAAhB,EAAsB;EACpB,WAAK0C,KAAL,CAAWqD,OAAX,CAAmB,KAAKvE,SAAL,GAAiB,GAAjB,GAAuBG,GAA1C,EAA+C,KAAKT,WAAL,CAAiBN,SAAjB,CAA2BZ,IAAI,CAAC2B,GAAD,CAA/B,CAA/C;EACD;EACD,WAAO,IAAP;EACD;EAEDS,EAAAA,OAAO,CAACL,IAAD,EAAO;EACZ,WAAOA,IAAI,CAAClB,GAAL,CAASF,CAAC,IAAI,KAAK+B,KAAL,CAAWsD,UAAX,CAAsB,KAAKxE,SAAL,GAAiB,GAAjB,GAAuBb,CAA7C,CAAd,CAAP;EACD;EAED0B,EAAAA,MAAM,GAAG;EACPlE,IAAAA,MAAM,CAAC4D,IAAP,CAAY,KAAKW,KAAjB,EAAwBjC,OAAxB,CAAgCE,CAAC,IAAI;EACnC,UAAIA,CAAC,CAACP,OAAF,CAAU,KAAKoB,SAAf,MAA8B,CAAlC,EAAqC,KAAKkB,KAAL,CAAWsD,UAAX,CAAsBrF,CAAtB;EACtC,KAFD;EAGA,WAAO,IAAP;EACD;EAED,MAAIwB,KAAJ,GAAY;EACV,WAAO,KAAKL,OAAL,CAAa3D,MAAM,CAAC4D,IAAP,CAAY,KAAKW,KAAjB,EAAwB7B,GAAxB,CAA4BF,CAAC,IAAI;EACnD,UAAIA,CAAC,CAACP,OAAF,CAAU,KAAKoB,SAAf,MAA8B,CAAlC,EAAqC,OAAOb,CAAC,CAACK,KAAF,CAAQ,KAAKQ,SAAL,CAAe7B,MAAf,GAAwB,CAAhC,CAAP;EACtC,KAFmB,EAEjBsG,MAFiB,CAEVtF,CAAC,IAAI,OAAOA,CAAP,KAAa,WAFR,CAAb,CAAP;EAGD;EAED,MAAI+B,KAAJ,GAAY;EACV,WAAO/D,MAAM,CAACuH,YAAd;EACD;EAED,aAAWzH,IAAX,GAAkB;EAChB,WAAO,cAAP;EACD;EAhDgC;EAmDnC,gBAAc,GAAGoH,YAAjB;;ECpDA,MAAMM,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAAT,EAAYC,WAAZ,EAAb;EACA,MAAMC,KAAK,GAAG,KAAd;EAAA,MAAqBC,UAAU,GAAG,IAAIC,MAAJ,CAAWF,KAAX,EAAkB,GAAlB,CAAlC;EAEA,MAAMG,OAAN,SAAsBtF,OAAtB,CAA8B;EAC5BD,EAAAA,WAAW,CAACE,OAAD,EAAU;EACnB,UAAMA,OAAN;EACD;EAEDyB,EAAAA,WAAW,GAAG;EACZ,QAAI4B,MAAM,GAAG,KAAK/B,KAAlB;EAAA,QAAyBzC,GAAG,GAAG,EAA/B;EACAwE,IAAAA,MAAM,CAAC5F,KAAP,CAAa,IAAb,EAAmB4B,OAAnB,CAA4BmB,KAAD,IAAW;EACpC,UAAI,CAACjB,CAAD,EAAID,CAAJ,IAASkB,KAAK,CAAC/C,KAAN,CAAY,GAAZ,CAAb;EACA,UAAI8B,CAAC,CAACP,OAAF,CAAU,KAAKoB,SAAf,MAA8B,CAAlC,EAAqCvB,GAAG,CAACU,CAAC,CAACK,KAAF,CAAQ,KAAKQ,SAAL,CAAe7B,MAAf,GAAwB,CAAhC,CAAD,CAAH,GAA0C,KAAKuB,WAAL,CAAiBnB,KAAjB,CAAuBW,CAAC,CAACgG,OAAF,CAAUH,UAAV,EAAsB,GAAtB,CAAvB,CAA1C;EACtC,KAHD;EAIA,WAAOtG,GAAP;EACD;EAEDiC,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,SAAK,IAAI2B,GAAT,IAAgB3B,IAAhB,EAAsB;EACpB,WAAK0C,KAAL,aAAgB,KAAKlB,SAArB,cAAkCG,GAAlC,cAAyC,KAAKT,WAAL,CAAiBN,SAAjB,CAA2BZ,IAAI,CAAC2B,GAAD,CAA/B,EAAsC+E,OAAtC,CAA8C,IAA9C,EAAoDJ,KAApD,CAAzC;EACD;EACD,WAAO,IAAP;EACD;EAEDjE,EAAAA,MAAM,GAAG;EACP,QAAIoC,MAAM,GAAG,KAAK/B,KAAlB;EACA+B,IAAAA,MAAM,CAAC5F,KAAP,CAAa,IAAb,EAAmB4B,OAAnB,CAA4BmB,KAAD,IAAW;EACpC,YAAMjB,CAAC,GAAGiB,KAAK,CAAC/C,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAV;EACA,UAAI8B,CAAC,CAACP,OAAF,CAAU,KAAKoB,SAAf,MAA8B,CAAlC,EAAqC;EACnC,aAAKkB,KAAL,aAAgB/B,CAAhB,wBAA+BwF,IAA/B;EACD;EACF,KALD;EAMD;EAED,MAAIzD,KAAJ,GAAY;EACV,WAAOD,QAAQ,CAACkE,MAAhB;EACD;EAED,MAAIjE,KAAJ,CAAUhC,CAAV,EAAa;EACX+B,IAAAA,QAAQ,CAACkE,MAAT,GAAkBjG,CAAlB;EACD;EAED,aAAWjC,IAAX,GAAkB;EAChB,WAAO,SAAP;EACD;EAzC2B;EA4C9B,WAAc,GAAGgI,OAAjB;;EC9CA,MAAMG,WAAN,SAA0BzF,OAA1B,CAAkC;EAChCD,EAAAA,WAAW,CAACE,OAAD,EAAUpB,IAAI,GAAG,EAAjB,EAAqB;EAC9B,UAAMoB,OAAN;EACA,SAAKe,KAAL,GAAahB,OAAO,CAACpB,KAAR,CAAcC,IAAd,CAAb;EACD;EAED6C,EAAAA,WAAW,GAAG;EACZ,WAAO,KAAKV,KAAZ;EACD;EAEDD,EAAAA,OAAO,CAAClC,IAAD,EAAO;EACZ,SAAK,IAAI2B,GAAT,IAAgB3B,IAAhB,EAAsB;EACpB,WAAKmC,KAAL,CAAWR,GAAX,IAAkB3B,IAAI,CAAC2B,GAAD,CAAtB;EACD;EACF;EAED,MAAIe,KAAJ,GAAY;EACV,WAAO,KAAKP,KAAZ;EACD;EAED,aAAW1D,IAAX,GAAkB;EAChB,WAAO,aAAP;EACD;EAtB+B;EAyBlC,eAAc,GAAGmI,WAAjB;;ECrBA,IAAIC,QAAQ,GAAG,EAAf;EACAA,QAAQ,CAAC1D,SAAS,CAAC1E,IAAX,CAAR,GAA2B0E,SAA3B;EACA0D,QAAQ,CAAC9B,MAAM,CAACtG,IAAR,CAAR,GAAwBsG,MAAxB;EACA8B,QAAQ,CAAChB,YAAY,CAACpH,IAAd,CAAR,GAA8BoH,YAA9B;EACAgB,QAAQ,CAACJ,OAAO,CAAChI,IAAT,CAAR,GAAyBgI,OAAzB;EACAI,QAAQ,CAACD,WAAW,CAACnI,IAAb,CAAR,GAA6BmI,WAA7B;EAEA,cAAc,GAAGC,QAAjB;;ECVA,MAAMC,YAAN,CAAmB;EACjB5F,EAAAA,WAAW,CAACE,OAAD,EAAU;EACnB,QAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiCA,OAAO,GAAG;EAAE2F,MAAAA,QAAQ,EAAE,CAAC3F,OAAD;EAAZ,KAAV,CAAjC,KAAyEA,OAAO,GAAGA,OAAO,IAAI,EAArB;EACzE,SAAKC,QAAL,GAAgBlD,MAAM,CAAC6I,MAAP,CAAc,KAAK9F,WAAL,CAAiB+F,cAA/B,EAA+C7F,OAA/C,CAAhB;EACA,WAAO,KAAK8F,OAAZ;EACD;EAED,MAAIA,OAAJ,GAAc;EACZ,QAAIA,OAAO,GAAG,KAAKC,cAAL,EAAd;EACA,QAAI,OAAOD,OAAP,KAAmB,WAAvB,EAAoC,MAAMrF,KAAK,CAAC,gDAAD,CAAX;EACpC,QAAIuF,gBAAgB,GAAG,KAAKlG,WAAL,CAAiBmG,iBAAjB,CAAmC,KAAKhG,QAAxC,EAAkD6F,OAAO,CAACzI,IAA1D,CAAvB;EACA,QAAI2I,gBAAJ,EAAsB;EAAE,aAAOA,gBAAP;EAA0B,KAAlD,MACK;EACH,UAAIE,eAAe,GAAG,IAAIJ,OAAJ,CAAY,KAAK7F,QAAjB,CAAtB;EACA,WAAKH,WAAL,CAAiBqG,IAAjB,CAAsBD,eAAtB;EACA,aAAOA,eAAP;EACD;EACF;EAED,MAAIP,QAAJ,GAAe;EACb,WAAO,KAAK1F,QAAL,CAAc0F,QAAd,CAAuBS,MAAvB,CAA8B,CAAC,WAAD,EAAc,QAAd,EAAwB,cAAxB,EAAwC,SAAxC,EAAmD,aAAnD,CAA9B,CAAP;EACD;EAEDL,EAAAA,cAAc,GAAG;EACf,SAAK,IAAIvH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKmH,QAAL,CAAcpH,MAAlC,EAA0CC,CAAC,EAA3C,EAA+C;EAC7C,UAAI8C,KAAK,GAAG,KAAKxB,WAAL,CAAiBuG,eAAjB,CAAiC,KAAKV,QAAL,CAAcnH,CAAd,CAAjC,CAAZ;EACA,UAAI8C,KAAK,IAAI,IAAIA,KAAJ,CAAU,KAAKrB,QAAf,EAAyBkB,WAAzB,EAAb,EAAqD,OAAOG,KAAP;EACtD;EACF;EAED,SAAO2E,iBAAP,CAAyBjG,OAAzB,EAAkC3C,IAAlC,EAAwC;EACtC,QAAIiJ,YAAY,GAAG,KAAK1F,GAAxB;EAAA,QAA6BpC,CAA7B;EACA,QAAID,MAAM,GAAG+H,YAAY,CAAC/H,MAA1B;EACA,SAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,MAAhB,EAAwBC,CAAC,EAAzB,EAA6B;EAC3B,UAAI8H,YAAY,CAAC9H,CAAD,CAAZ,CAAgB0C,QAAhB,CAAyBlB,OAAzB,EAAkC3C,IAAlC,CAAJ,EAA6C,OAAOiJ,YAAY,CAAC9H,CAAD,CAAnB;EAC9C;EACD,WAAO,KAAP;EACD;EAED,SAAO2H,IAAP,CAAYI,QAAZ,EAAsB;EACpB,SAAK3F,GAAL,CAASuB,IAAT,CAAcoE,QAAd;EACD;EAED,aAAWV,cAAX,GAA4B;EAC1B,WAAO;EACLF,MAAAA,QAAQ,EAAE,EADL;EAELzF,MAAAA,IAAI,EAAE,cAFD;EAGLC,MAAAA,OAAO,EAAE,CAHJ;EAILE,MAAAA,WAAW,EAAE,eAJR;EAKL8D,MAAAA,IAAI,EAAE,IAAI,IAAJ,GAAW;EALZ,KAAP;EAOD;EAED,SAAOqC,IAAP,CAAY5H,IAAZ,EAAkB;EAChB,WAAO,IAAI4G,WAAJ,CAAgB,EAAhB,EAAoB5G,IAApB,CAAP;EACD;EAvDgB;EA0DnB8G,YAAY,CAACW,eAAb,GAA+BZ,UAA/B;EACAC,YAAY,CAAC9E,GAAb,GAAmB,EAAnB;EAEA,iBAAc,GAAG8E,YAAjB;;;;;;;;;;;"}