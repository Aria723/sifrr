!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.Sifrr=t.Sifrr||{},t.Sifrr.DOM=e())}(this,function(){"use strict";var t=class{static absolute(t,e){let n=t.split("/"),s=e.split("/");n.pop();for(let t=0;t<s.length;t++)"."!=s[t]&&(".."==s[t]?n.pop():n.push(s[t]));return n.join("/")}static getRoutes(t){"/"!=t[0]&&(t="/"+t);let e=t.indexOf("?");return-1!=e&&(t=t.substring(0,e)),t.split("/")}};"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e;(function(t,e){var n;t.exports=(n=class{constructor(t,e,n){this.type=t,this._options=n,this._url=e}get response(){return window.fetch(this.url,this.options).then(t=>{let e,n=t.headers.get("content-type");if(e=n&&n.includes("application/json")?t.json():t.text(),t.ok)return e;{let n=Error(t.statusText);throw n.response=e,n}})}get url(){let t=delete this._options.params;return t&&Object.keys(t).length>0?this._url+"?"+Object.keys(t).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e])).join("&"):this._url}get options(){return Object.assign(this._options,{method:this.type,headers:Object.assign({accept:"application/json"},this._options.headers||{}),mode:"cors",redirect:"follow"})}},class{static get(t,e={}){return new n("GET",t,e).response}static post(t,e={}){return new n("POST",t,e).response}static put(t,e={}){return new n("PUT",t,e).response}static delete(t,e={}){return new n("DELETE",t,e).response}static file(t,e={}){return e.headers=e.headers||{},e.headers.accept=e.headers.accept||"*/*",new n("GET",t,e).response}})})(e={exports:{}},e.exports);var n=class{constructor(t){this.name=t.name,this.html=t.html,this.base=t,this._isElementOk()&&this._create()}_isElementOk(){if(this.name)if(window.customElements.get(this.name))console.log(`Error creating Element: ${this.name} - Element with this name is already defined.`);else{if(!(this.name.indexOf("-")<1))return!0;console.log(`Error creating Element: ${this.name} - Element name must have one dash '-'`)}else console.log("Error creating Element: No name given.");return!1}_create(){let e=document.createElement("link");const n=function(e,n){return class extends HTMLElement{static get observedAttributes(){return["sifrr-state"].concat(n.observedAttributes||[])}constructor(){super();const s=e.import.querySelector("template");if("true"==s.getAttribute("relative-url")){let n=e.href,i=/href=['"]?((?!http)[a-zA-z.\/\-\_]+)['"]?/g,r=/src=['"]?((?!http)[a-zA-z.\/\-\_]+)['"]?/g,a=s.innerHTML.replace(i,o);function o(e,s){return e.replace(s,t.absolute(n,s))}a=a.replace(r,o),s.innerHTML=a}"false"===s.getAttribute("shadow-root")?n.sr=!1:(this.attachShadow({mode:"open"}).appendChild(s.content.cloneNode(!0)),n.sr=!0),"false"===s.getAttribute("state")&&Object.defineProperty(this,"state",{set:function(t){console.log("State is not enabled for ",this)},get:function(){console.log("State is not enabled for ",this)}}),n.vdom=SFComponent.toVDOM(s.content.cloneNode(!0)),"function"==typeof n.createdCallback&&n.createdCallback(this)}attributeChangedCallback(t,e,s){"data-bind"===t&&(this.state={bind:tryParseJSON(s)}),"function"==typeof n.attributeChangedCallback&&n.attributeChangedCallback(this,t,e,s)}connectedCallback(){let t=n.defaultState||{},e=tryParseJSON(this.dataset.bind)||{},s=this.state;this.state=Object.assign(t,{bind:e},s),this.shadowRoot?this.shadowRoot.addEventListener("change",SFComponent.twoWayBind):this.addEventListener("change",SFComponent.twoWayBind),"function"==typeof n.connectedCallback&&n.connectedCallback(this)}disconnectedCallback(){"function"==typeof n.disconnectedCallback&&n.disconnectedCallback(this)}clone(t=!0){let e=this.cloneNode(t);return e.state=this.state,e}get state(){return this._state}set state(t){this._state=this._state||{};let e=Object.assign({},this._state);Object.assign(this._state,t),SFComponent.updateState(this,e)}get sifrr(){return!0}clearState(){this._state={},SFComponent.updateState(this)}}}(e,this.base);e.rel="import",e.href=this.html,e.setAttribute("async",""),e.onload=function(t){try{window.customElements.define(this.name,n)}catch(t){console.log(`Error creating Element: ${this.name} - ${t}`)}},e.onerror=function(t){console.log(t)},window.document.head.appendChild(e)}};class s{constructor(t,e=null){this.name=t;let n=t.split("-").join("/");return this.html="string"==typeof e?e:"/elements/"+n+".html",Array.isArray(t)?t.map(t=>new this.constructor(t)):"object"==typeof t?Object.keys(t).map(e=>new this.constructor(e,t[e])):(this._registerElement(),void this.constructor.add(t,this))}_registerElement(){this.customElement=new n(this)}static add(t,e){this.elements[t]=e}}return s.elements={},s});
