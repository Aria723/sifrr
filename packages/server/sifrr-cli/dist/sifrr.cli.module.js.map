{"version":3,"file":"sifrr.cli.module.js","sources":["../src/utils/check.js","../src/utils/seqconfig.js","../src/commands/db.js","../src/templates/element.js","../../../../node_modules/mkdirp/index.js","../src/utils/createfile.js","../src/commands/elementgenerate.js","../src/sifrr.cli.js"],"sourcesContent":["const exec = require('child_process').execSync;\n\nfunction check(cmnd, err) {\n  let isWorking;\n  try {\n    exec(cmnd, { stdio: 'ignore' });\n    isWorking = true;\n  } catch(e) {\n    isWorking = false;\n  }\n\n  if (!isWorking) {\n    process.stderr.write(err);\n    process.exit(1);\n    return false;\n  }\n\n  return true;\n}\n\nmodule.exports = check;\n","const path = require('path');\n\nglobal.ENV = global.ENV || process.env.NODE_ENV || process.env.ENV || 'development';\nconst configFile = require(path.resolve('./.sequelizerc')).config;\nconst config = require(path.resolve(configFile))[ENV];\n\nmodule.exports = config;\n","const exec = require('child_process').execSync;\n\nconst seqCMD = 'PATH=$(npm bin):$PATH sequelize';\nconst supportedCmds = ['reset', 'setup'];\nconst logs = {\n  reset: (dbName) => `Database ${dbName} dropped and recreated.`,\n  setup: (dbName) => `Database ${dbName} set up.`\n};\n\nmodule.exports = (cmd) => {\n  return () => {\n    if (supportedCmds.indexOf(cmd) < 0) throw Error('This db command not supported. Supported commands: \\n', supportedCmds.map(c => `db:${c}`).join('\\n'));\n\n    require('../utils/check')(`${seqCMD} --version`, 'sequelize-cli is required to run this command. Install it by running `npm i sequelize-cli`');\n\n    const config = require('../utils/seqconfig');\n    global.console.log(`Using ${config.dialect} in ${ENV} environment`);\n    const db = require(`./db/${config.dialect}.js`);\n\n    db(config, cmd, (err) => {\n      if (err) throw err;\n\n      global.console.log(logs[cmd](config.database));\n      process.stdout.write(`Running migrations`);\n      exec(`${seqCMD} db:migrate`, { stdio: 'inherit' });\n      process.stdout.write(`Done`);\n\n      process.exit(0);\n    });\n  };\n};\n","module.exports = (name, ext) => {\n  return `window.Sifrr = window.Sifrr || {};\nwindow.Sifrr.Dom = window.Sifrr.Dom || require('@sifrr/dom');\nconst Sifrr = window.Sifrr;\n\nconst template = Sifrr.Dom.template\\`<!-- Content -->\\`\n\nclass ${name} extends Sifrr.Dom.Element${ext ? `.extends(${ext})` : ''} {\n  onConnect() {\n\n  }\n\n  onDisconnect() {\n\n  }\n}\n${name}.defaultState = {};\nSifrr.Dom.register(${name}${ext ? ', { extends: \\'/* tag of html to extend, eg. tr */\\' }' : ''});\n`;\n};\n","var path = require('path');\nvar fs = require('fs');\nvar _0777 = parseInt('0777', 8);\n\nmodule.exports = mkdirP.mkdirp = mkdirP.mkdirP = mkdirP;\n\nfunction mkdirP (p, opts, f, made) {\n    if (typeof opts === 'function') {\n        f = opts;\n        opts = {};\n    }\n    else if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n    \n    var cb = f || function () {};\n    p = path.resolve(p);\n    \n    xfs.mkdir(p, mode, function (er) {\n        if (!er) {\n            made = made || p;\n            return cb(null, made);\n        }\n        switch (er.code) {\n            case 'ENOENT':\n                mkdirP(path.dirname(p), opts, function (er, made) {\n                    if (er) cb(er, made);\n                    else mkdirP(p, opts, cb, made);\n                });\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                xfs.stat(p, function (er2, stat) {\n                    // if the stat fails, then that's super weird.\n                    // let the original error be the failure reason.\n                    if (er2 || !stat.isDirectory()) cb(er, made)\n                    else cb(null, made);\n                });\n                break;\n        }\n    });\n}\n\nmkdirP.sync = function sync (p, opts, made) {\n    if (!opts || typeof opts !== 'object') {\n        opts = { mode: opts };\n    }\n    \n    var mode = opts.mode;\n    var xfs = opts.fs || fs;\n    \n    if (mode === undefined) {\n        mode = _0777 & (~process.umask());\n    }\n    if (!made) made = null;\n\n    p = path.resolve(p);\n\n    try {\n        xfs.mkdirSync(p, mode);\n        made = made || p;\n    }\n    catch (err0) {\n        switch (err0.code) {\n            case 'ENOENT' :\n                made = sync(path.dirname(p), opts, made);\n                sync(p, opts, made);\n                break;\n\n            // In the case of any other error, just see if there's a dir\n            // there already.  If so, then hooray!  If not, then something\n            // is borked.\n            default:\n                var stat;\n                try {\n                    stat = xfs.statSync(p);\n                }\n                catch (err1) {\n                    throw err0;\n                }\n                if (!stat.isDirectory()) throw err0;\n                break;\n        }\n    }\n\n    return made;\n};\n","const fs = require('fs');\nconst path = require('path');\nconst mkdirp = require('mkdirp');\n\nmodule.exports = (elemPath, content, force = false) => {\n  mkdirp.sync(path.dirname(elemPath), (err) => {\n    /* istanbul ignore next */\n    if (err) throw err;\n  });\n\n  if (fs.existsSync(elemPath) && !force) {\n    process.stderr.write(`File already exists at ${elemPath}`);\n    process.exit(1);\n    return false;\n  }\n\n  fs.writeFileSync(elemPath, content, err => {\n    /* istanbul ignore next */\n    if(err) throw err;\n  });\n\n  process.stdout.write(`File was saved at '${elemPath}'!`);\n  return true;\n};\n","const elemTemplate = require('../templates/element');\nconst createFile = require('../utils/createfile');\nconst path = require('path');\n\nmodule.exports = (argv) => {\n  // Element class\n  const elemName = argv.name;\n  // Loader\n  const elemPath = path.resolve(argv.path, `./${elemName.split('-').join('/')}.js`);\n  const className = elemName.replace(/-([a-z])/g, (g) => g[1].toUpperCase()).replace(/^([a-z])/, (g) => g[0].toUpperCase());\n\n  const elemHtml = elemTemplate(className, argv.extends);\n\n  createFile(elemPath, elemHtml, argv.force === 'true');\n};\n","module.exports = {\n  db: require('./commands/db.js'),\n  elementGenerate: require('./commands/elementgenerate')\n};\n"],"names":["require$$0","global","require","exec","require$$1","require$$2","elemTemplate","createFile"],"mappings":"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"}